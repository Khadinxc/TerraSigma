// Title: Suspicious Child Process of SolarWinds WebHelpDesk
// Author: Huntress Team, Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2026-02-11
// Level: high
// Description: Detects suspicious child processes spawned by SolarWinds WebHelpDesk (WHD) application, which may indicate exploitation activity leveraging RCE vulnerabilities such as CVE-2025-40551, CVE-2025-40536, or CVE-2025-26399
// MITRE Tactic: Initial Access
// Tags: attack.initial-access, attack.t1190, cve.2025-26399, cve.2025-40536, cve.2025-40551, detection.emerging-threats

DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "tomcat" and InitiatingProcessFolderPath contains "\\WebHelpDesk\\bin\\" and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) and (ProcessCommandLine contains "-enc" or ProcessCommandLine contains "base64" or ProcessCommandLine contains "bitsadmin" or ProcessCommandLine contains "certutil" or ProcessCommandLine contains "curl" or ProcessCommandLine contains "Invoke-RestMethod" or ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "irm " or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "msiexec" or ProcessCommandLine contains "Net.WebClient" or ProcessCommandLine contains "Start-BitsTransfer" or ProcessCommandLine contains "wget" or ProcessCommandLine contains "wmic")